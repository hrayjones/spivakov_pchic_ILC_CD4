# RELI Analysis

This document will cover how RELI analysis was perfomed using the PIR features generated from the pcHi-C data. The outputs were collected from the [`../notebooks/20220606_spivakov_pchic_reanalysis.ipynb`](../notebooks/20220606_spivakov_pchic_reanalysis.ipynb) analysis that are found in [`./pchic/data/feature_intersection`](../data/feature_intersection/).

## Workflow Overview

RELI (v 0.1.1a) was used to find enrichment of genetic variants in promoter interacting regions (PIRs) that are accessible and marked with activating epigenetic markers (H3K27ac and ATAC-seq). In brief, RELI tests genomic features such as ATAC-seq, ChIP-seq, or PIRs for statistically significant overlaps with known disease risk variants identified from genome-wide association studies. 

### Convert the hg38 PIRs to hg19 intervals using UCSC liftover

```bash
# Lift over the hg38 bed files to hg19
for file in /Users/caz3so/workspaces/tacazares/pchic/data/outputs/PIR_intersection/*;
do
liftover ${file} \
./data/genome_inf/hg38ToHg19.over.chain.gz \
./data/RELI/feature_liftover/`basename ${file}` \
./data/RELI/feature_liftover_unmapped/`basename ${file}`_unmapped.txt
done
```

### LD Blocks

Risk variants are expanded to linkage disequilibrium blocks (LD blocks) with variants that have an R2 value ≥ 0.8. LD blocks are then intersected with the genetic feature BED files. A null distribution is generated using randomly shuffled LD blocks (n=1,000) and performing the intersection with the feature files. A p-value is generated by comparing the observed number of intersections in the test to the null distribution.

### Generating PIR sets

The PIR sets were defined as the other ends of the BEDPE files output from CHiCAGO. Interactions had to have a score of ≥ 5. We excluded trans-chromosomal and promoter to promoter interactions. ATAC-seq, H3K27ac, and H3K4me3 were intersected with each PIR set. The intersection of the features was used. We used UCSC liftover (v. 377) lo lift over the genomic coordinates from hg38 to hg19 for use with RELI. The RE features used in this analysis are the union of ATAC-seq data with H3K27ac data for each cell type. All intervals were sorted and merged before input into RELI. 

### Pvalue correction for multiple hypothesis testing using Benjamini-Hochberg procedure

Bonferroni and Benjamini-Hochberg pvalue correction were performed with the python package statsmodels with an alpha=0.05 (family-wise error rate of 5%; the probability that at least one of your predictions is a false positive).